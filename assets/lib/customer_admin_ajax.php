<?php include(dirname(dirname(dirname(__FILE__)))."/objects/class_connection.php");include(dirname(dirname(dirname(__FILE__))).'/objects/class_users.php');include(dirname(dirname(dirname(__FILE__))).'/objects/class_order_client_info.php');include(dirname(dirname(dirname(__FILE__))).'/objects/class_setting.php');include(dirname(dirname(dirname(__FILE__))).'/objects/class_booking.php');$con = new cleanto_db();$conn = $con->connect();$user=new cleanto_users();$order_client_info=new cleanto_order_client_info();$setting = new cleanto_setting();$setting->conn = $conn;    $booking = new cleanto_booking();    $booking->conn = $conn;$getdateformat=$setting->get_option('ct_date_picker_date_format');$time_format = $setting->get_option('ct_time_format');$user->conn=$conn;$order_client_info->conn=$conn;$lang = $setting->get_option("ct_language");$label_language_values = array();$language_label_arr = $setting->get_all_labelsbyid($lang);if ($language_label_arr[1] != "" || $language_label_arr[3] != "" || $language_label_arr[4] != "" || $language_label_arr[5] != ""){	$default_language_arr = $setting->get_all_labelsbyid("en");	if($language_label_arr[1] != ''){		$label_decode_front = base64_decode($language_label_arr[1]);	}else{		$label_decode_front = base64_decode($default_language_arr[1]);	}	if($language_label_arr[3] != ''){		$label_decode_admin = base64_decode($language_label_arr[3]);	}else{		$label_decode_admin = base64_decode($default_language_arr[3]);	}	if($language_label_arr[4] != ''){		$label_decode_error = base64_decode($language_label_arr[4]);	}else{		$label_decode_error = base64_decode($default_language_arr[4]);	}	if($language_label_arr[5] != ''){		$label_decode_extra = base64_decode($language_label_arr[5]);	}else{		$label_decode_extra = base64_decode($default_language_arr[5]);	}	$label_decode_front_unserial = unserialize($label_decode_front);	$label_decode_admin_unserial = unserialize($label_decode_admin);	$label_decode_error_unserial = unserialize($label_decode_error);	$label_decode_extra_unserial = unserialize($label_decode_extra);    	$label_language_arr = array_merge($label_decode_front_unserial,$label_decode_admin_unserial,$label_decode_error_unserial,$label_decode_extra_unserial);		foreach($label_language_arr as $key => $value){		$label_language_values[$key] = urldecode($value);	}}else{	$default_language_arr = $setting->get_all_labelsbyid("en");    	$label_decode_front = base64_decode($default_language_arr[1]);	$label_decode_admin = base64_decode($default_language_arr[3]);	$label_decode_error = base64_decode($default_language_arr[4]);	$label_decode_extra = base64_decode($default_language_arr[5]);		$label_decode_front_unserial = unserialize($label_decode_front);	$label_decode_admin_unserial = unserialize($label_decode_admin);	$label_decode_error_unserial = unserialize($label_decode_error);	$label_decode_extra_unserial = unserialize($label_decode_extra);    	$label_language_arr = array_merge($label_decode_front_unserial,$label_decode_admin_unserial,$label_decode_error_unserial,$label_decode_extra_unserial);		foreach($label_language_arr as $key => $value){		$label_language_values[$key] = urldecode($value);	}}if(isset($_POST['getclient_bookings_details'])){	/*new file include*/	include(dirname(dirname(dirname(__FILE__))).'/assets/lib/date_translate_array.php');    /* client id */    $user->user_id = $_POST['id'];    $clientinfo = $user->readone();    $client_id = $clientinfo[0];    /* get all bookings of the selected client */    $clientbooking = $user->get_user_bookingss();    $cnti = 1;    while($cc = mysqli_fetch_array($clientbooking)){        if($cc['booking_status']=='A')		{			$booking_stats=$label_language_values['active'];		}		elseif($cc['booking_status']=='C')		{			$booking_stats=$label_language_values['confirm'];		}		elseif($cc['booking_status']=='R')		{			$booking_stats=$label_language_values['reject'];		}		elseif($cc['booking_status']=='RS')		{			$booking_stats=$label_language_values["rescheduled"];		}		elseif($cc['booking_status']=='CC')		{			$booking_stats=$label_language_values['cancel_by_client'];		}		elseif($cc['booking_status']=='CS')		{			$booking_stats=$label_language_values['cancelled_by_service_provider'];		}		elseif($cc['booking_status']=='CO')		{			$booking_stats=$label_language_values['completed'];		}		else		{			$cc['booking_status']=='MN';			$booking_stats=$label_language_values['mark_as_no_show'];		}           ?>        <tr>            <td><?php echo $cnti;?></td>            <td><?php echo $cc['sname'];?></td>           <?php			if($time_format == 12){			?>			<td><?php echo str_replace($english_date_array,$selected_lang_label,date($getdateformat." h:i A",strtotime($cc['booking_date_time'])));?></td>			<?php			}else{			?>            <td><?php echo str_replace($english_date_array,$selected_lang_label,date($getdateformat." H:i",strtotime($cc['booking_date_time'])));?></td>			<?php			}			?>            <td><?php echo $booking_stats;?></td>            <td><?php  if($cc['pna'] != 0){ echo $cc['c_payment_method'];} else { echo "Free";};?></td>            <td>                <?php                /* methods */                $units = $label_language_values['none'];                $methodname=$label_language_values['none'];                $hh = $booking->get_methods_ofbookings($cc['order_id']);                $count_methods = mysqli_num_rows($hh);                $hh1 = $booking->get_methods_ofbookings($cc['order_id']);                if($count_methods > 0){                    while($jj = mysqli_fetch_array($hh1)){                        if($units == $label_language_values['none']){                            $units = $jj['units_title']."-".$jj['qtys'];                        }                        else                        {                            $units = $units.",".$jj['units_title']."-".$jj['qtys'];                        }                        $methodname = $jj['method_title'];                    }                }                $addons = $label_language_values['none'];                $hh = $booking->get_addons_ofbookings($cc['order_id']);                while($jj = mysqli_fetch_array($hh)){                    if($addons == $label_language_values['none']){                        $addons = $jj['addon_service_name']."-".$jj['addons_service_qty'];                    }                    else                    {                        $addons = $addons.",".$jj['addon_service_name']."-".$jj['addons_service_qty'];                    }                }                ?>                <b><?php echo $label_language_values['methods'];?></b> - <?php echo $methodname;?>                <br>                <b><?php echo $label_language_values['units'];?></b> - <?php echo $units;?>                <br>                <b><?php echo $label_language_values['addons'];?></b> - <?php echo $addons;?>            </td>        </tr>    <?php    $cnti++;}?><?php}elseif(isset($_POST['guest'])){	/*new file include*/	include(dirname(dirname(dirname(__FILE__))).'/assets/lib/date_translate_array.php');    /* get all bookings of the selected client */    $order_id = $_POST['orderid'];    $clientbooking = $user->get_bookings_guests($_POST['orderid'],$_POST['email']);    $cntgi = 1;        while($cc = mysqli_fetch_array($clientbooking)){            if($cc['booking_status']=='A')            {                $booking_stats=$label_language_values['active'];            }            elseif($cc['booking_status']=='C')            {                $booking_stats=$label_language_values['confirm'];            }            elseif($cc['booking_status']=='R')            {                $booking_stats=$label_language_values['reject'];            }            elseif($cc['booking_status']=='RS')            {                $booking_stats=$label_language_values["rescheduled"];            }            elseif($cc['booking_status']=='CC')            {                $booking_stats=$label_language_values['cancel_by_client'];            }            elseif($cc['booking_status']=='CS')            {                $booking_stats=$label_language_values['cancelled_by_service_provider'];            }            elseif($cc['booking_status']=='CO')            {                $booking_stats=$label_language_values['completed'];            }            else            {                $cc['booking_status']=='MN';                $booking_stats=$label_language_values['mark_as_no_show'];            }            ?>            <tr>                <td><?php echo $cntgi;?></td>                <td><?php echo $cc['sname'];?></td>                <?php				if($time_format == 12){				?>				<td><?php echo str_replace($english_date_array,$selected_lang_label,date("".$getdateformat." h:i A",strtotime($cc['booking_date_time'])));?></td>				<?php				}else{				?>				<td><?php echo str_replace($english_date_array,$selected_lang_label,date("".$getdateformat." H:i",strtotime($cc['booking_date_time'])));?></td>				<?php				}				?>                <td><?php echo $booking_stats;?></td>                <td><?php  if($cc['pna'] != 0){ echo $cc['c_payment_method'];} else { echo "Free";};?></td>                <td>                    <?php                    /* methods */                    $units = $label_language_values['none'];                    $methodname=$label_language_values['none'];                    $hh = $booking->get_methods_ofbookings($order_id);                    $count_methods = mysqli_num_rows($hh);                    $hh1 = $booking->get_methods_ofbookings($order_id);                    if($count_methods > 0){                        while($jj = mysqli_fetch_array($hh1)){                            if($units == $label_language_values['none']){                                $units = $jj['units_title']."-".$jj['qtys'];                            }                            else                            {                                $units = $units.",".$jj['units_title']."-".$jj['qtys'];                            }                            $methodname = $jj['method_title'];                        }                    }                    $addons = $label_language_values['none'];                    $hh = $booking->get_addons_ofbookings($order_id);                    while($jj = mysqli_fetch_array($hh)){                        if($addons == $label_language_values['none']){                            $addons = $jj['addon_service_name'];                        }                        else                        {                            $addons = $addons.",".$jj['addon_service_name'];                        }                    }                    ?>                    <b><?php echo $label_language_values['methods'];?></b> - <?php echo $methodname;?>                    <br>                    <b><?php echo $label_language_values['units'];?></b> - <?php echo $units;?>                    <br>                    <b><?php echo $label_language_values['addons'];?></b> - <?php echo $addons;?>                </td>            </tr>        <?php       $cntgi++; }?><?php }elseif(isset($_POST['delete_guest_bookings'])){$order_id = $_POST['orderid'];    $user->delete_bookings_guestcustomers($order_id);}elseif(isset($_POST['delete_registered_bookings'])){	$usersid = $_POST['usersid'];    $user->delete_bookings_registeredcustomers($usersid);}?>